# config.py
import os
from dataclasses import dataclass
from typing import List, Dict, Any
import random

@dataclass
class Config:
    """Конфигурация генератора"""
    model_name: str = "mixtral:latest"
    ollama_url: str = "http://localhost:11434/api/generate"
    target_count: int = 5000
    delay_between_requests: float = 2.0
    output_filename: str = "synthetic_dataset.json"
    
    # Настройки промптов
    topics: List[str] = None
    scenarios: List[str] = None
    industries: List[str] = None
    professions: List[str] = None
    emotions: List[str] = None
    difficulties: List[str] = None
    
    # Настройки модели
    temperature: float = 0.8
    top_p: float = 0.95
    num_predict: int = 350
    repeat_penalty: float = 1.2
    
    def __post_init__(self):
        if self.topics is None:
            self.topics = self._get_extended_topics()
        
        if self.scenarios is None:
            self.scenarios = self._get_extended_scenarios()
        
        if self.industries is None:
            self.industries = self._get_industries()
        
        if self.professions is None:
            self.professions = self._get_professions()
        
        if self.emotions is None:
            self.emotions = self._get_emotions()
        
        if self.difficulties is None:
            self.difficulties = ["простой", "средний", "сложный"]
    
    def _get_extended_topics(self) -> List[str]:
        """Возвращает расширенный список тем"""
        return [
            # Быт и повседневность
            "бытовые вопросы", "домашние дела", "семейные отношения", 
            "уход за детьми", "домашние животные", "ремонт в доме",
            "уборка и организация", "приготовление пищи", "шопинг",
            "личная гигиена", "здоровый сон", "фитнес дома",
            
            # Технологии и IT
            "программирование", "веб-разработка", "мобильные приложения",
            "искусственный интеллект", "машинное обучение", "кибербезопасность",
            "облачные технологии", "базы данных", "DevOps",
            "игровая индустрия", "VR/AR технологии", "IoT устройства",
            "робототехника", "блокчейн и криптовалюты", "big data",
            
            # Образование
            "школьное образование", "вузовское обучение", "онлайн-курсы",
            "языковые курсы", "подготовка к экзаменам", "научные исследования",
            "методики обучения", "профориентация", "самообразование",
            "дистанционное обучение", "лабораторные работы", "написание статей",
            
            # Медицина и здоровье
            "первая помощь", "хронические заболевания", "профилактика болезней",
            "психическое здоровье", "правильное питание", "физиотерапия",
            "стоматология", "педиатрия", "геронтология",
            "спортивная медицина", "альтернативная медицина", "диагностика",
            
            # Бизнес и финансы
            "стартапы", "инвестиции", "управление проектами",
            "маркетинг", "продажи", "бюджетирование",
            "налогообложение", "банковские услуги", "страхование",
            "фриланс", "удаленная работа", "переговоры",
            
            # Культура и искусство
            "живопись", "скульптура", "фотография",
            "литература", "поэзия", "кинематограф",
            "театр", "музыка", "танцы",
            "архитектура", "дизайн", "мода",
            
            # Наука
            "физика", "химия", "биология",
            "астрономия", "геология", "математика",
            "экология", "климатология", "генетика",
            "археология", "антропология", "лингвистика",
            
            # Путешествия
            "туризм", "походы", "кемпинг",
            "городские экскурсии", "пляжный отдых", "горнолыжный спорт",
            "гастрономические туры", "экотуризм", "паломничество",
            "круизы", "сафари", "дайвинг",
            
            # Спорт
            "командные виды спорта", "индивидуальный спорт", "экстремальный спорт",
            "фитнес", "йога", "плавание",
            "велоспорт", "бег", "бокс",
            "шахматы", "киберспорт", "автоспорт",
            
            # Юриспруденция
            "гражданское право", "уголовное право", "трудовое право",
            "семейное право", "налоговое право", "авторское право",
            "международное право", "конституционное право", "административное право",
            
            # Психология
            "когнитивная психология", "клиническая психология", "социальная психология",
            "детская психология", "семейная психология", "профориентационная психология",
            "нейропсихология", "психодиагностика", "психокоррекция",
            
            # Сельское хозяйство
            "растениеводство", "животноводство", "садоводство",
            "фермерство", "агротехнологии", "экологическое земледелие",
            
            # Транспорт и логистика
            "автомобили", "авиация", "морские перевозки",
            "железнодорожный транспорт", "логистика", "навигация",
            
            # Строительство
            "архитектурное проектирование", "ремонтные работы", "инженерные системы",
            "ландшафтный дизайн", "интерьерный дизайн", "строительные материалы",
            
            # Социальные вопросы
            "волонтерство", "благотворительность", "экологические проблемы",
            "социальное неравенство", "миграция", "толерантность",
            
            # Хобби и развлечения
            "коллекционирование", "рукоделие", "кулинария",
            "видеоигры", "чтение", "просмотр сериалов",
            "астрология", "нумерология", "гадания",
            
            # Религия и философия
            "религиоведение", "этика", "мораль",
            "философские учения", "мифология", "эзотерика",
        ]
    
    def _get_extended_scenarios(self) -> List[str]:
        """Возвращает расширенный список сценариев"""
        return [
            # Базовые сценарии
            "вопрос-ответ", "просьба-реакция", "жалоба-решение",
            "консультация-рекомендация", "инструкция-выполнение",
            "объяснение-понимание", "совет-принятие",
            
            # Деловые сценарии
            "запрос предложения - коммерческое предложение",
            "претензия - извинение и компенсация",
            "переговоры - достижение соглашения",
            "интервью - ответы на вопросы",
            "презентация - вопросы аудитории",
            "мозговой штурм - генерация идей",
            
            # Образовательные сценарии
            "экзаменационный вопрос - ответ студента",
            "задача - решение с пояснениями",
            "непонимание темы - разъяснение",
            "запрос дополнительных материалов - предоставление ресурсов",
            "обсуждение проекта - критика и предложения",
            
            # Технические сценарии
            "баг-репорт - решение проблемы",
            "запрос техподдержки - инструкция по устранению",
            "документирование - запрос уточнений",
            "код ревью - комментарии и предложения",
            "архитектурное решение - обоснование выбора",
            
            # Медицинские сценарии
            "симптомы пациента - предварительный диагноз",
            "запрос о лекарстве - инструкция по применению",
            "консультация о процедуре - объяснение этапов",
            "результаты анализов - интерпретация",
            "реабилитация - рекомендации по восстановлению",
            
            # Бытовые сценарии
            "рецепт - уточнение деталей",
            "ремонт - советы по выполнению",
            "покупка - сравнение вариантов",
            "планирование мероприятия - предложения",
            "конфликтная ситуация - пути разрешения",
            
            # Креативные сценарии
            "запрос на творческую идею - предложение концепции",
            "критика работы - конструктивная обратная связь",
            "мозговой штурм - нестандартные решения",
            "сценарий - развитие сюжета",
            "дизайн-задача - варианты решения",
            
            # Социальные сценарии
            "просьба о помощи - предложение поддержки",
            "эмоциональная поддержка - утешение и совет",
            "конфликт - медиация и примирение",
            "знакомство - поддержание беседы",
            "прощание - теплые слова",
            
            # Специализированные
            "юридическая консультация - разъяснение норм",
            "финансовый совет - рекомендации по управлению",
            "техническая спецификация - уточнение требований",
            "научная гипотеза - обоснование и критика",
            "художественный анализ - интерпретация произведения",
        ]
    
    def _get_industries(self) -> List[str]:
        """Возвращает список отраслей"""
        return [
            "IT и технологии", "финансы и банкинг", "здравоохранение",
            "образование", "розничная торговля", "производство",
            "строительство", "транспорт и логистика", "туризм и гостиницы",
            "медиа и развлечения", "недвижимость", "сельское хозяйство",
            "энергетика", "телекоммуникации", "реклама и маркетинг",
            "юридические услуги", "консалтинг", "государственный сектор",
            "НКО и благотворительность", "наука и исследования",
        ]
    
    def _get_professions(self) -> List[str]:
        """Возвращает список профессий"""
        return [
            "программист", "врач", "учитель", "инженер", "юрист",
            "бухгалтер", "маркетолог", "менеджер", "дизайнер", "аналитик",
            "ученый", "писатель", "журналист", "архитектор", "психолог",
            "переводчик", "логист", "повар", "строитель", "фермер",
            "водитель", "пилот", "моряк", "спасатель", "полицейский",
            "военный", "дипломат", "артист", "музыкант", "спортсмен",
        ]
    
    def _get_emotions(self) -> List[str]:
        """Возвращает список эмоциональных состояний"""
        return [
            "радостный", "грустный", "сердитый", "испуганный", "удивленный",
            "спокойный", "взволнованный", "разочарованный", "гордый", "стыдливый",
            "любопытный", "саркастичный", "ироничный", "нейтральный", "энтузиастичный",
            "скептический", "оптимистичный", "пессимистичный", "ностальгический", "игривый",
        ]
    
    def get_random_context(self) -> Dict[str, str]:
        """Генерирует случайный контекст для промпта"""
        return {
            "topic": random.choice(self.topics),
            "scenario": random.choice(self.scenarios),
            "industry": random.choice(self.industries),
            "profession": random.choice(self.professions),
            "emotion": random.choice(self.emotions),
            "difficulty": random.choice(self.difficulties),
            "style": random.choice(["формальный", "неформальный", "технический", "творческий", "простой"])
        }
    
    @classmethod
    def from_dict(cls, config_dict: dict) -> 'Config':
        """Создает конфиг из словаря"""
        return cls(**config_dict)